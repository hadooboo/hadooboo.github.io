---
layout: mil
date: 1619794800
title: Spring 세계가 깨어지는 경험
tag: 삼정데이타서비스
permalink: /mils/202105
---

아무 생각 없이 살아가다 보면 점점 새로운 것을 시도해보려고 하지 않게 되는 것이 인간의 습성이라고 생각한다. 마치 멈춰져 있는 바퀴를 굴리기 위해서는 더 많은 힘이 드는 것처럼. 내게도 spring이라는 세상이 그러하였고, 그게 마냥 답인 줄 알았다.

네이버에서 2번의 인턴 활동을 하며 백엔드 서버는 모두 spring boot으로 만들었다. 두 번에서 모두 기본적인 API 서비스 제공이 목표였고 실제 운영으로 이어지기 전 단계였으므로 spring boot에서 부족함을 느낄 수 없었다. 학교에서 수업을 들을 때에도 대부분 java 언어로 배워왔기에, 다른 언어로 다른 프레임워크로 서버를 만드는 것이 아직은 시기상조라는 생각을 막연히 가지게 되었다. 내가 하려고 했던 유일한 발전은 java 언어 대신 kotlin으로 spring을 사용하고자 하는 것이었다.

이런 생각을 가지고 입사한 회사에서 내가 가장 처음으로 마주한 코드는 go로 만들어진 테스트용 시뮬레이션 프로그램이었다. 단순히 이 프로그램 뿐만 아니라 회사에서 만드는 백엔드 서버를 항상 go로 만들고 있다고 했다. Go라는 언어는 빠르고 쉽다는 정도는 들어본 적이 있었지만 실제로 이렇게까지 널리 사용되고 있는 줄은 몰랐다.

더욱이 놀란 것은 매우 간단한 문법을 가지고 있으면서도 성능이 좋다는 것이었다. 시뮬레이션 프로그램은 채 200줄이 안되는 코드였지만 goroutine을 이용해 병렬 프로그래밍을 구현하고 있었고, 그 자체로 하나의 실행 파일이 빌드가 되어 쉽게 여러 대의 컴퓨터에서 돌릴 수 있었다. goroutine을 무한히 늘린다고 좋은 것은 아니기 때문에 channel이라는 문법을 사용하여 실행하는 goroutine의 개수를 조정하고 있었는데 이것도 흥미로운 점이었다.

그러나 goroutine의 장점에 눈이 멀어 쉽게 할 수 있는 최적화를 놓치지는 않아야겠다고 생각했다. 회사의 시뮬레이션 프로그램을 보니 원하는 작업이 `A -> B -> C` 라면 이 모든 작업을 각각의 goroutine에서 반복하고 있었다. `A` 는 데이터 파일을 읽어오는 부분이었는데 결국 자료구조에 저장해 놓고 읽기 전용으로 사용하고 있어 굳이 매번 그 엄청난 오버헤드를 가지는 파일 I/O를 할 필요가 없었다. 이를 수정하여 커밋하였고, 여러 컴퓨터에서 하루씩 걸리던 작업을 하나의 컴퓨터에서 1~2시간 안에 끝낼 수 있었다.

찾아보니 go라는 언어 자체가 c를 개발한 사람들이 c의 복잡함이 싫어서 개발하기 시작했다는데 사용하면 할수록 그 점을 여실히 알 수 있었다. 키워드 개수도 많지 않았고, 자체적으로 gc를 제공하기 때문에 메모리를 직접 관리할 필요도 없었다. 함수의 리턴 값으로 여러 개의 변수를 지정할 수 있는 것, exception 대신 error를 리턴하는 것, 그에 따라 무한히 많아지는 `if err != nil` 코드도 go 언어만의 특징이라고 생각한다. 무엇보다도 앞에서도 언급한 쉬운 goroutine 사용도 큰 강점으로 보인다. 여러 언어들을 배워가며 그 언어를 만드는 사람들이 가지고 있는 철학을 되짚어가는 일은 참 재밌다.